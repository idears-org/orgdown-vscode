#+TITLE: Include Directive - Canonicalized Tests

#+NAME: Simple include with quoted path
#+BEGIN_FIXTURE
#+INCLUDE: "otherfile.org"
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | "otherfile.org" |

#+NAME: Include with options (:lines)
#+BEGIN_FIXTURE
#+INCLUDE: "otherfile.org" :lines "1-10"
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | "otherfile.org" |
#+EXPECTED: :type scope
":lines" => {{scopes.BLOCK_PARAMETER_KEY}}
'"1-10"' => {{scopes.BLOCK_PARAMETER_VALUE}}

#+NAME: Include with minlevel option
#+BEGIN_FIXTURE
#+INCLUDE: "otherfile.org" :minlevel 2
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | "otherfile.org" |

#+NAME: Include with example and only-contents
#+BEGIN_FIXTURE
#+INCLUDE: "otherfile.org" :example :only-contents t
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | "otherfile.org" |

#+NAME: Include with comments option
#+BEGIN_FIXTURE
#+INCLUDE: "otherfile.org" :comments t
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | "otherfile.org" |

#+NAME: Include after headline
#+BEGIN_FIXTURE
* Heading
#+INCLUDE: "headline.org"
#+END_FIXTURE

#+EXPECTED: :type scope
'#+INCLUDE: "headline.org"' => {{scopes.META_DIRECTIVE}}, {{scopes.INCLUDE_KEYWORD}}, {{scopes.INCLUDE_PATH}}

#+NAME: Include inside list item
#+BEGIN_FIXTURE
- Item 1
  #+INCLUDE: "list.org"
- Item 2
#+END_FIXTURE

#+EXPECTED: :type scope
'#+INCLUDE: "list.org"' => {{scopes.META_DIRECTIVE}}, {{scopes.INCLUDE_KEYWORD}}, {{scopes.INCLUDE_PATH}}

#+NAME: Include inside table cell
#+BEGIN_FIXTURE
| Table | With | Include |
|-------+------+---------|
| #+INCLUDE: "table.org" | Foo | Bar |
#+END_FIXTURE

#+EXPECTED: :type scope
'#+INCLUDE: "table.org"' => !{{scopes.META_DIRECTIVE}}, !{{scopes.INCLUDE_KEYWORD}}, !{{scopes.INCLUDE_PATH}}

#+NAME: Include inside comment should be treated as comment content
#+BEGIN_FIXTURE
# This is a comment with #+INCLUDE: "commented.org"
#+END_FIXTURE

#+EXPECTED: :type scope
'# This is a comment with #+INCLUDE: "commented.org"' => {{scopes.COMMENT_LINE}}

#+NAME: Malformed include should not match begin regex
#+BEGIN_FIXTURE
#+INCLUDE "missing-colon.org"
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
no-match

#+NAME: Empty quoted include is valid (matches begin regex)
#+BEGIN_FIXTURE
#+INCLUDE: ""
#+END_FIXTURE

#+EXPECTED: :type regex :name includeDirectiveBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | #+INCLUDE:     |
| 2       | ""             |

#+NAME: Include with bare and single-quoted paths
#+BEGIN_FIXTURE
#+INCLUDE: bare/path/file.org
#+INCLUDE: 'single/quoted.org'
#+END_FIXTURE
#+EXPECTED: :type scope
"bare/path/file.org" => {{scopes.INCLUDE_PATH}}
"'single/quoted.org'" => {{scopes.INCLUDE_PATH}}

#+NAME: Case-insensitive INCLUDE keyword
#+BEGIN_FIXTURE
#+include: "case.org"
#+END_FIXTURE
#+EXPECTED: :type scope
"#+include:" => {{scopes.INCLUDE_KEYWORD}}
'"case.org"' => {{scopes.INCLUDE_PATH}}

#+NAME: Include with extra whitespace
#+BEGIN_FIXTURE
#+INCLUDE:    "extra/space.org"    :lines   "1-5"
#+END_FIXTURE
#+EXPECTED: :type scope
'"extra/space.org"' => {{scopes.INCLUDE_PATH}}
":lines" => {{scopes.BLOCK_PARAMETER_KEY}}
'"1-5"' => {{scopes.BLOCK_PARAMETER_VALUE}}

#+NAME: Show Case - scope assertions for INCLUDE
#+BEGIN_FIXTURE
#+INCLUDE: "file.org" :lines "1-3" :minlevel 2 :only-contents t
#+END_FIXTURE
#+EXPECTED: :type scope
'#+INCLUDE: "file.org"' => {{scopes.META_DIRECTIVE}}, {{scopes.INCLUDE_KEYWORD}}, {{scopes.INCLUDE_PATH}}
":lines" => {{scopes.BLOCK_PARAMETER_KEY}}
'"1-3"' => {{scopes.BLOCK_PARAMETER_VALUE}}
":minlevel" => {{scopes.BLOCK_PARAMETER_KEY}}
"2" => {{scopes.BLOCK_PARAMETER_VALUE}}
":only-contents" => {{scopes.BLOCK_PARAMETER_KEY}}
"t" => {{scopes.BLOCK_PARAMETER_VALUE}}
