#+TITLE: Comprehensive Test Suite for Standard Blocks

#+BEGIN_COMMENT :description Expected Scopes & Capture Groups:

* === Block Scopes ===
# The following meta scopes are applied to the entire standard block.
- meta.block.org
- meta.block.standard.org

# The following content scopes are applied to the content of the block.
- markup.block.org
- markup.block.standard.org

* === Capture Group Scopes (Begin Regex) ===
1. indentation -> string.other.whitespace.leading.org
2. begin keyword -> keyword.control.block.org
3. block name -> entity.name.function.block.org
4. parameters -> variable.parameter.block.org
   - :key -> variable.parameter.key.org
   - value -> string.unquoted.parameter.value.org

#+END_COMMENT

* 1. Integration Test Cases

This section is the primary source for the snapshot test. It should contain
various valid and edge-case examples of QUOTE, EXAMPLE, VERSE, CENTER, and
COMMENT blocks.

** 1.1. Basic Functionality

#+BEGIN_QUOTE
This is a simple quote block.
It can span multiple lines.
#+END_QUOTE

#+BEGIN_EXAMPLE
This is an example block.
It preserves whitespace literally.
  Indentation is respected.
#+END_EXAMPLE

#+BEGIN_VERSE
  A block for verse,
  where lines can be terse.
#+END_VERSE

#+BEGIN_CENTER
This text should be centered.
As should this.
#+END_CENTER

#+BEGIN_COMMENT
This is a comment block.
Its content should not be exported.
#+END_COMMENT

** 1.2. Case Insensitivity

#+begin_quote
Lowercase begin.
#+end_quote

#+BEGIN_EXAMPLE
Mixed case end.
#+EnD_ExAmPlE

** 1.3. Indentation

  #+BEGIN_VERSE
  This whole block is indented.
  The content is also indented.
  #+END_VERSE

** 1.4. Content-Specific Parsing

*** 1.4.1. Markup-Enabled Blocks (QUOTE, VERSE, CENTER)

#+BEGIN_QUOTE
This quote should have *bold* and /italic/ text.
#+END_QUOTE

#+BEGIN_VERSE
This verse also supports ~code~ and +strikethrough+.
#+END_VERSE

*** 1.4.2. Verbatim Blocks (COMMENT, EXAMPLE)

#+BEGIN_EXAMPLE
This example should NOT have *bold* or /italic/ text.
It is all literal.
A line starting with * should be literal text, not a headline.
#+END_EXAMPLE

#+BEGIN_COMMENT
Similarly, this comment block should not process ~code~ or _underline_.
#+END_COMMENT

** 1.5. Nesting

- A list item.
  - A nested list item.
    #+BEGIN_CENTER
    A centered block, nested deep in a list.
    #+END_CENTER

** 1.6. Error Handling & Robustness

*** 1.6.1. Mismatched End Marker

#+BEGIN_QUOTE
This block starts with QUOTE...
#+END_EXAMPLE
...but ends with EXAMPLE. The END line should not be recognized as closing this block, so the QUOTE block scope should continue.

This text should still be inside the QUOTE block.

* 2. Unit Test Cases

This section contains isolated unit tests for the begin regexes. The end regexes
cannot be unit-tested here due to their use of backreferences.

#+NAME: Unit Test: Markup Begin (QUOTE)
#+BEGIN_FIXTURE
#+BEGIN_QUOTE
#+END_QUOTE
#+END_FIXTURE

#+EXPECTED: standardBlockMarkupBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       |                |
| 2       | #+BEGIN_       |
| 3       | QUOTE          |
| 4       |                |

#+NAME: Unit Test: Markup (VERSE, indented, case-insensitive, with params)
#+BEGIN_FIXTURE
  #+bEgIn_VeRsE with params
  #+eNd_VeRsE
#+END_FIXTURE

#+EXPECTED: standardBlockMarkupBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       | <sp:2>         |
| 2       | #+bEgIn_       |
| 3       | VeRsE          |
| 4       | with params    |

#+NAME: Unit Test: Verbatim Begin (EXAMPLE)
#+BEGIN_FIXTURE
#+BEGIN_EXAMPLE
#+END_EXAMPLE
#+END_FIXTURE

#+EXPECTED: standardBlockVerbatimBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       |                |
| 2       | #+BEGIN_       |
| 3       | EXAMPLE        |
| 4       |                |

#+NAME: Unit Test: Verbatim Begin (COMMENT, case-insensitive, with params)
#+BEGIN_FIXTURE
#+begin_comment with params
#+end_comment
#+END_FIXTURE

#+EXPECTED: standardBlockVerbatimBeginRegex
| Group # | Expected Value |
|---------+----------------|
| 1       |                |
| 2       | #+begin_       |
| 3       | comment        |
| 4       | with params    |

#+NAME: Unit Test: Non-match (SRC should not match standard block regex)
#+BEGIN_FIXTURE
#+BEGIN_SRC
#+END_SRC
#+END_FIXTURE

#+EXPECTED: standardBlockMarkupBeginRegex
no-match

#+EXPECTED: standardBlockVerbatimBeginRegex
no-match
